<!DOCTYPE html>
<html lang="it">
  <head>
    <title>The Bocchette 2 - Bocchet pass</title>
    <!-- START <meta> -->
    <meta charset="UTF-8">
    <!-- END <meta> -->

    <!-- Content -->
    <link rel="icon" href="https://docs.google.com/drawings/d/e/2PACX-1vRzg3r27e7_yLyB4m8rlyFHgQ8H5d6IJtW39axawbD5u7S_eX3ezqZdtll3NBLxJYY_OUhuSGJ-jQ8T/pub?w=16&h=16" type="image/x-icon">
    <link rel="stylesheet" href="/resources/EmojiSupport.css">
    <script src="/var.js"></script>
    <script src="/cons/console.js"></script>
    <script src="/SchedDes.js"></script>
  </head>
  <body style="font-family: 'Trebuchet MS', 'Lucida Sans Unicode', 'Lucida Grande', 'Lucida Sans', Arial, sans-serif; background-color: #195e79ad; margin: 0px;">

    <div style="display: flex; flex-direction: row; justify-content: flex-start;">
      <back onclick="window.location.href = '/game/home.html';" style="cursor: pointer; text-decoration: none; font-size: 25px; border: solid 2px black;" title="Indietro">⬅️</back>
    </div>

    <div style="display: flex; flex-direction: row; flex-wrap: nowrap; justify-content: space-evenly; align-items: baseline; margin-top: -21px;">
      <button onclick="window.location.href = '/game/pass/pass.html'" style="background: gold; border-style: solid; border-top-left-radius: 6px;border-top-right-radius: 6px;">Ricompense</button>
      <button onclick="window.location.href = '/game/pass/miss.html'" style="background: darkgray; border-style: solid; border-top-left-radius: 6px;border-top-right-radius: 6px;">Missioni</button>
    </div>

    <div style="display: flex; flex-direction: column; width: 100%; height: 658px;">
      <div style="height: 50%; width: 100%; display: flex; justify-content: flex-start; align-items: stretch;">

        <div style="width: 160px; background-color: goldenrod; display: flex; flex-direction: column; align-items: center; justify-content: center;padding-block: 89.4px;">
          <hx style="cursor: default;">Premium Pass</hx>
          <img src="/resources/TB2/Pass_Premium_icon.png" alt="Errore di fonte" style="width: 70px;"><br>
          <button style="background-color: #edc200; border-radius: 8px; border: solid 2px; cursor: pointer;" onclick="shopPP()" id="butt_APP">Acquista</button>
          <hx style="color: red; margin-top: 7px; cursor: default;">Ricompense x2</hx>
        </div>

        <!-- Pass premium -->
        <div style="display: flex; flex-direction: column; background-color: #daa520ab; height: 100%; width: 100%; justify-content: center; align-items: flex-start;" class="PassBar">
          <div style="width: 1050px; height: 5px; background: black; margin-left: 5%; margin-right: 5%;" name="pass premium">
            <div class="ProgressLine" style="width: 1%; height: 5px; background: dodgerblue;" name="Progress line" NOTE="every avanzament: width +4%"></div>
            <div style="display: flex;flex-direction: row;justify-content: flex-start;align-items: flex-start;margin-top: -5px;">

              <div style="display: flex; flex-direction: column; align-items: center; margin-top: -6px; margin-left: 15px;" name="obb">
                <button tabindex="-1" style="/*border-radius: 10px;*/ outline: none; border: 0px; background-color: dodgerblue; color: white;">1</button>
                <div style="background: black; width: 3px; height: 20px;" name="line"></div>
                <div style="background: gray; width: 60px; height: 60px; border: solid 3px black;" name="figur" id="SfObb1">
                  <img src="/resources/TB2/Valùta_icon.png" alt="Errore di fonte" style="width: 100%;" title="200 banconote" onclick="RRPP('200 banconote', 'SfObb1', '1');">
                </div>
              </div>

              <div style="display: flex; flex-direction: column; align-items: center; margin-top: -6px; margin-left: 15px;" name="obb">
                <button tabindex="-1" style="/*border-radius: 10px;*/ outline: none; border: 0px; background-color: dodgerblue; color: white;">2</button>
                <div style="background: black; width: 3px; height: 20px;" name="line"></div>
                <div style="background: gray; width: 60px; height: 60px; border: solid 3px black;" name="figur" id="SfObb2">
                  <img src="/resources/TB2/Casse/Cassa_Rara.png" alt="Errore di fonte" style="width: 100%;" title="Cassa Rara" onclick="RRPP('1 CRar', 'SfObb2', '2');">
                </div>
              </div>

              <div style="display: flex; flex-direction: column; align-items: center; margin-top: -6px; margin-left: 15px;" name="obb">
                <button tabindex="-1" style="/*border-radius: 10px;*/ outline: none; border: 0px; background-color: dodgerblue; color: white;">3</button>
                <div style="background: black; width: 3px; height: 20px;" name="line"></div>
                <div style="background: gray; width: 60px; height: 60px; border: solid 3px black;" name="figur" id="SfObb3">
                  <img src="/resources/TB2/Gemme_Icon.png" alt="Errore di fonte" style="width: 100%;" title="10 Gemme" onclick="RRPP('10 Gem', 'SfObb3', '3');">
                </div>
              </div>
              
            </div>
          </div>
        </div>

      </div>


      <div style="height: 45%;width: 100%;display: flex;justify-content: flex-start;align-items: stretch;">
        <div style="width: 160px;background-color: #dadada;display: flex;flex-direction: column;align-items: center;justify-content: center;height: unset;">
          <hx style="cursor: default;">Pass Gratuito</hx>
          <img src="/resources/TB2/Pass_gratis_icon.png" alt="Errore di fonte" style="width: 70px;"><br>
        </div>

        <!-- Pass gratis -->
        <div style="display: flex; align-items: flex-start; flex-direction: column; justify-content: center; height: unset; width: 100%; background-color: #dadadaab;" class="PassBar">
          <div style="width: 1050px; height: 5px; background: black; margin-left: 5%; margin-right: 5%;" name="pass gratis">
            <div class="ProgressLine" style="width: 1%; height: 5px; background: dodgerblue;" name="Progress line" NOTE="every avanzament: width +4%"></div>
            <div style="display: flex;flex-direction: row;align-items: flex-end;justify-content: flex-start;margin-top: -5px;">
              
              <div style="display: flex; flex-direction: column; align-items: center; margin-top: -6px; margin-left: 15px;" name="obb">
                <button tabindex="-1" style="/*border-radius: 10px;*/ outline: none; border: 0px; background-color: dodgerblue; color: white;">1</button>
                <div style="background: black; width: 3px; height: 20px;" name="line"></div>
                <div style="background: gray; width: 60px; height: 60px; border: solid 3px black;" name="figur">
                  <img src="/resources/TB2/Valùta_icon.png" alt="Errore di fonte" style="width: 100%;" title="100 banconote">
                </div>
              </div>

              <div style="display: flex; flex-direction: column; align-items: center; margin-top: -6px; margin-left: 15px;" name="obb">
                <button tabindex="-1" style="/*border-radius: 10px;*/ outline: none; border: 0px; background-color: dodgerblue; color: white;">2</button>
                <div style="background: black; width: 3px; height: 20px;" name="line"></div>
                <div style="background: gray; width: 60px; height: 60px; border: solid 3px black;" name="figur">
                  <img src="/resources/TB2/Valùta_icon.png" alt="Errore di fonte" style="width: 100%;" title="200 banconote">
                </div>
              </div>

              <div style="display: flex; flex-direction: column; align-items: center; margin-top: -6px; margin-left: 15px;" name="obb">
                <button tabindex="-1" style="/*border-radius: 10px;*/ outline: none; border: 0px; background-color: dodgerblue; color: white;">3</button>
                <div style="background: black; width: 3px; height: 20px;" name="line"></div>
                <div style="background: gray; width: 60px; height: 60px; border: solid 3px black;" name="figur">
                  <img src="/resources/TB2/Casse/Cassa_Comune.png" alt="Errore di fonte" style="width: 100%;" title="Cassa Comune">
                </div>
              </div>

              <div style="display: flex; flex-direction: column; align-items: center; margin-top: -6px; margin-left: 15px;" name="obb">
                <button tabindex="-1" style="/*border-radius: 10px;*/ outline: none; border: 0px; background-color: dodgerblue; color: white;">4</button>
                <div style="background: black; width: 3px; height: 20px;" name="line"></div>
                <div style="background: gray; width: 60px; height: 60px; border: solid 3px black;" name="figur">
                  <img src="/resources/TB2/Gemme_Icon.png" alt="Errore di fonte" style="width: 100%;" title="5 Gemme">
                </div>
              </div>

            </div>
          </div>
        </div>

      </div>

    </div>


  </body>
</html>

<script>
  function createReactiveVar(initialValue) {
    let value = initialValue;
    let onChangeCallback = null;

    const reactiveVar = {
      get value() {
        return value;
      },
      set value(newValue) {
        if (value !== newValue) {
          value = newValue;
          if (onChangeCallback) {
            onChangeCallback(newValue);
          }
        }
      },
      set onChange(callback) {
        if (typeof callback === 'function') {
          onChangeCallback = callback;
        }
      },
      get onChange() {
        return !!onChangeCallback;
      }
    };

    return reactiveVar;
  }

  obb.onChange = function() {
    updateProgressLine(obb);
  };


  let progressLines = document.querySelectorAll('.ProgressLine');
  let oldObb = 0;

  // Funzione per aggiornare la barra di progresso
  function updateProgressLine(newObb) {
    if (newObb !== oldObb) {
      let difference = newObb - oldObb;

      // Itera su tutte le linee di progresso
      progressLines.forEach(progressLine => {
        // Se la larghezza della linea è già impostata
        let currentWidth = parseInt(progressLine.style.width) || 0;

        // Aumenta o diminuisce la larghezza in base alla differenza di obb
        if (difference > 0) {
          progressLine.style.width = (currentWidth + 4) + "%";
        } else if (difference < 0) {
          progressLine.style.width = (currentWidth - 4) + "%";
        }
      });

      // Aggiorna il vecchio valore di obb
      oldObb = newObb;
    }
  }
</script>

<style>
  .PassBar  {
    overflow-x: auto;
  }
  * {
    user-select: none;
  }
</style>

<script>// Controlla ricompensa già riscatt.
  //guarda /var.js
</script>

<script>
  function RRPP(ricomp, id, obbRicomp) { // Riscatta Ricompensa Pass Premium
    if (passP == 1) { //Controlla Premium Pass (riscatto ricomps. pass premium)
      let SfObbId = document.getElementById(id).style;
      if (obbRicomp <= obb) {
        switch (ricomp) {
          case "200 banconote":
            if (SfObbId.background == 'gray') {
              soldi = parseInt(soldi) + 200;
              SfObbId.background = 'green';
            } else {
              window.alert("Ricompensa già riscattata.");
            }
          break;
          case '1 CRar':
            //aumenta di +1 le cass rare
            NCassRar = parseInt(NCassRar) + 1;
            window.location.href;
          break;
          case '10 Gem':
            gemme = parseInt(gemme) + 10;
          break;
          default:
            //window.alert("Errore: Ricompensa di switch(), non valida!");
            console.error("Ricompensa di switch(), non valida!")
          break;
        }
      } else {
        alert("Devi raggiungere l'obbiettivo "+obbRicomp+" per riscattare questa ricompensa.")
      }
      
    } else {
      window.alert("Devi acquistare il Pass Premium per riscattare questa ricompensa")
    }
  }
</script>

<script> //shop Premium Pass
  let butt = document.getElementById("butt_APP");
  if (passP == 1) {
    butt.disabled = true;
  }

  function shopPP() {
    let conf = window.confirm("Vuoi comprare il Premium Pass per 8.000 gemme?");
    if (conf == true) {
      if (gemme >= 8000) {
        passP = 1;
        gemme = gemme - 8000;
        window.alert("Pass Premium acquistato");
        butt.disabled = true;
      } else {
        window.alert("Gemme insufficenti!");
      }
    }
  }
</script>
