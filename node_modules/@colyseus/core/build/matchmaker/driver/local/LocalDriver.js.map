{
  "version": 3,
  "sources": ["../../../../src/matchmaker/driver/local/LocalDriver.ts"],
  "sourcesContent": ["import { logger } from '../../../Logger.js';\nimport { IRoomCache, SortOptions, RoomCache, MatchMakerDriver } from '../api.js';\n\n// re-export\nexport type { IRoomCache, SortOptions, RoomCache, MatchMakerDriver };\n\nimport { Query } from './Query.js';\nimport { RoomData } from './RoomData.js';\n\nexport class LocalDriver implements MatchMakerDriver {\n  public rooms: IRoomCache[] = [];\n\n  public createInstance(initialValues: any = {}) {\n    return new RoomData(initialValues, this.rooms);\n  }\n\n  public has(roomId: string) {\n    return this.rooms.some((room) => room.roomId === roomId);\n  }\n\n  public query(conditions: Partial<IRoomCache>, sortOptions?: SortOptions) {\n    const query = new Query<RoomCache>(this.rooms, conditions);\n\n    if (sortOptions) {\n      query.sort(sortOptions);\n    }\n\n    return query.filter(conditions);\n  }\n\n  public cleanup(processId: string) {\n    const cachedRooms = this.query({ processId });\n    logger.debug(\"> Removing stale rooms by processId:\", processId, `(${cachedRooms.length} rooms found)`);\n\n    cachedRooms.forEach((room) => room.remove());\n    return Promise.resolve();\n  }\n\n  public findOne(conditions: Partial<IRoomCache>, sortOptions?: SortOptions) {\n    const query = new Query<RoomCache>(this.rooms, conditions);\n\n    if (sortOptions) {\n      query.sort(sortOptions);\n    }\n\n    return query as unknown as Promise<RoomCache>;\n  }\n\n  public clear() {\n    this.rooms = [];\n  }\n\n  public shutdown() {\n  }\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBAAuB;AAMvB,mBAAsB;AACtB,sBAAyB;AAElB,MAAM,YAAwC;AAAA,EAA9C;AACL,SAAO,QAAsB,CAAC;AAAA;AAAA,EAEvB,eAAe,gBAAqB,CAAC,GAAG;AAC7C,WAAO,IAAI,yBAAS,eAAe,KAAK,KAAK;AAAA,EAC/C;AAAA,EAEO,IAAI,QAAgB;AACzB,WAAO,KAAK,MAAM,KAAK,CAAC,SAAS,KAAK,WAAW,MAAM;AAAA,EACzD;AAAA,EAEO,MAAM,YAAiC,aAA2B;AACvE,UAAM,QAAQ,IAAI,mBAAiB,KAAK,OAAO,UAAU;AAEzD,QAAI,aAAa;AACf,YAAM,KAAK,WAAW;AAAA,IACxB;AAEA,WAAO,MAAM,OAAO,UAAU;AAAA,EAChC;AAAA,EAEO,QAAQ,WAAmB;AAChC,UAAM,cAAc,KAAK,MAAM,EAAE,UAAU,CAAC;AAC5C,yBAAO,MAAM,wCAAwC,WAAW,IAAI,YAAY,MAAM,eAAe;AAErG,gBAAY,QAAQ,CAAC,SAAS,KAAK,OAAO,CAAC;AAC3C,WAAO,QAAQ,QAAQ;AAAA,EACzB;AAAA,EAEO,QAAQ,YAAiC,aAA2B;AACzE,UAAM,QAAQ,IAAI,mBAAiB,KAAK,OAAO,UAAU;AAEzD,QAAI,aAAa;AACf,YAAM,KAAK,WAAW;AAAA,IACxB;AAEA,WAAO;AAAA,EACT;AAAA,EAEO,QAAQ;AACb,SAAK,QAAQ,CAAC;AAAA,EAChB;AAAA,EAEO,WAAW;AAAA,EAClB;AACF;",
  "names": []
}
